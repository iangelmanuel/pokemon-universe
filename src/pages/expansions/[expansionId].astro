---
import type { GetStaticPaths } from "astro"
import Layout from "../../layouts/Layout.astro"
import { PokemonTCG } from "pokemon-tcg-sdk-typescript"
import { Image } from "astro:assets"

export const getStaticPaths = (async () => {
  const expansions = await PokemonTCG.getAllSets()

  return expansions.map((expansion) => ({
    params: { expansionId: expansion.id },
    props: { expansion }
  }))
}) satisfies GetStaticPaths

const { expansion } = Astro.props

const expansionCards = await PokemonTCG.findCardsByQueries({
  q: `set.id:${expansion.id}`
})
---

<Layout>
  <main class="max-w-screen-lg mx-auto p-4 mt-10">
    <div class="bg-black rounded-4xl shadow-lg p-4 mb-10">
      <Image
        src={expansion.images.logo}
        alt={expansion.name}
        width={200}
        height={300}
        loading="lazy"
        class="w-[450px] mx-auto"
      />
    </div>

    <button onclick="history.back()">Ir atras</button>
    <h1 class="font-extrabold text-4xl">
      Bienvenido a la expansi√≥n de {expansion.name}
    </h1>

    <section
      class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mt-10"
    >
      {
        expansionCards.map((card) => (
          <div class="mt-4">
            <Image
              src={card.images.small}
              alt={card.name}
              width={200}
              height={300}
              loading="lazy"
              class="w-full h-auto rounded-lg shadow-lg"
            />
            <h2 class="text-2xl font-bold">{card.name}</h2>
          </div>
        ))
      }
    </section>
  </main>
</Layout>
